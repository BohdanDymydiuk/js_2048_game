const t=new class{constructor(t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]){this.cells=t,this.initialCells=t.map(t=>[...t]),this.isGameStarted=!1,this.score=0}moveLeft(){let t=this.cells.map(t=>[...t]);if(!0===this.isGameStarted){let e=0;this.cells.forEach(t=>{for(let s=0;s<t.length-1;s++)t[s]&&t[s]===t[s+1]&&([t[s],t[s+1]]=[t[s]*=2,0],this.score+=t[s],e+=1);for(let s=1;s<t.length;s++)for(let l=s;l>0;l--){if(0===t[l-1]){[t[l-1],t[l]]=[t[l],t[l-1]];continue}if(t[l-1]===t[l]&&e<2){[t[l-1],t[l]]=[t[l-1]*=2,0],this.score+=t[l-1],e+=1;break}}}),!0===this.isBoardChanged(this.cells,t)&&this.addStartingValue()}}moveRight(){let t=this.cells.map(t=>[...t]);if(!0===this.isGameStarted){let e=0;this.cells.forEach(t=>{for(let s=t.length-1;s>0;s--)t[s]&&t[s]===t[s-1]&&([t[s],t[s-1]]=[t[s]*=2,0],this.score+=t[s],e+=1);for(let s=t.length-2;s>=0;s--)for(let l=s;l<t.length-1;l++){if(0===t[l+1]){[t[l+1],t[l]]=[t[l],t[l+1]];continue}if(t[l+1]===t[l]&&e<2){[t[l+1],t[l]]=[t[l+1]*=2,0],this.score+=t[l+1],e+=1;break}}}),!0===this.isBoardChanged(this.cells,t)&&this.addStartingValue()}}moveUp(){let t=this.cells,e=t.map(t=>[...t]);if(!0===this.isGameStarted){for(let e=0;e<t[0].length;e++){let s=0;t.forEach((l,i)=>{i<t.length-1&&t[i][e]&&t[i+1][e]===t[i][e]&&(t[i][e]*=2,t[i+1][e]=0,this.score+=t[i][e],s+=1)});for(let l=1;l<t.length;l++)for(let i=l;i>0;i--){if(0===t[i-1][e]){t[i-1][e]=t[i][e],t[i][e]=0;continue}if(t[i-1][e]===t[i][e]&&s<1){t[i-1][e]*=2,t[i][e]=0,s+=1,this.score+=t[i-1][e];break}}}!0===this.isBoardChanged(t,e)&&this.addStartingValue()}}moveDown(){let t=this.cells,e=t.map(t=>[...t]);if(!0===this.isGameStarted){for(let e=0;e<t[0].length;e++){let s=0;for(let l=t.length-1;l>=0;l--)l>0&&t[l][e]&&t[l-1][e]===t[l][e]&&(t[l][e]*=2,t[l-1][e]=0,this.score+=t[l][e],s+=1);for(let l=t.length-2;l>=0;l--)for(let i=l;i<t.length-1;i++){if(0===t[i+1][e]){t[i+1][e]=t[i][e],t[i][e]=0;continue}if(t[i+1][e]===t[i][e]&&s<1){t[i+1][e]*=2,t[i][e]=0,this.score+=t[i+1][e],s+=1;break}}}!0===this.isBoardChanged(t,e)&&this.addStartingValue()}}getScore(){return this.score}getState(){return this.cells}getStatus(){let t=this.cells.some((t,e)=>t.some((s,l)=>e<this.cells.length-1&&(s===t[l+1]||s===this.cells[e+1][l])||e===this.cells.length-1&&s===t[l+1]));return this.cells.some(t=>t.some(t=>2048===t))?"win":this.cells.every(t=>t.every(t=>0!==t))&&!1===t?"lose":!1===this.isGameStarted?"idle":!0===this.isGameStarted?"playing":void 0}start(){let t=this.getStartRow(),e=this.getStartCell(t),s=this.getStartRow(),l=this.getStartCell(s);if(t===s&&e===l)return this.start();let i=this.getStartValue(),r=this.getStartValue();this.cells[t][e]=i,this.cells[s][l]=r,this.isGameStarted=!0}restart(){this.cells.forEach((t,e)=>t.forEach((s,l)=>{t[l]=this.initialCells[e][l]})),this.isGameStarted=!1,this.score=0}addStartingValue(){let t=this.getStartRow(),e=this.getStartCell(t),s=this.getStartValue();this.cells[t][e]=s}getStartRow(){let t=Math.floor(Math.random()*this.cells.length);return this.cells[t].every(t=>0!==t)?this.getStartRow():t}getStartCell(t){let e=Math.floor(Math.random()*this.cells[t].length);return 0===this.cells[t][e]?e:this.getStartCell(t)}getStartValue(){return .9>=Math.random()?2:4}isBoardChanged(t,e){return t.some((t,s)=>t.some((t,l)=>t!==e[s][l]))}},e=document.querySelectorAll(".field-cell"),s=document.querySelector(".message-win"),l=document.querySelector(".message-lose"),i=document.querySelector(".message-start"),r=document.querySelector(".game-score"),a=document.querySelector(".button");function h(){t.cells.forEach((t,s)=>t.forEach((l,i)=>{let r=i+s*t.length;0===l?e[r].innerHTML="":e[r].innerHTML=l,""===e[r].innerHTML?e[r].className="field-cell":e[r].className=`field-cell field-cell--${e[r].innerHTML}`})),r.innerHTML=t.score}a.addEventListener("click",()=>{a.classList.toggle("start"),a.classList.toggle("restart");let e=a.classList[1];a.classList.contains("restart")&&(t.start(),i.classList.add("hidden")),a.classList.contains("start")&&(t.restart(),s.classList.add("hidden"),l.classList.add("hidden"),i.classList.remove("hidden")),a.innerHTML=e[0].toUpperCase()+e.slice(1),h()}),window.addEventListener("keydown",e=>{if(a.classList.contains("restart")){switch(e.key){case"ArrowLeft":t.moveLeft();break;case"ArrowUp":t.moveUp();break;case"ArrowRight":t.moveRight();break;case"ArrowDown":t.moveDown()}h(),"win"===t.getStatus()&&s.classList.remove("hidden"),"lose"===t.getStatus()&&l.classList.remove("hidden")}});
//# sourceMappingURL=index.1b3bf601.js.map
